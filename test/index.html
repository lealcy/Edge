<!doctype html>
<html lang='en'>
    <head>
        <meta charset='UTF-8' />
        <title>tile engine</title>
    </head>
    <body>
        <canvas id='canvas' width='640' height='480'></canvas>
        <script src='../src/Game.js'></script>
        <script src='../src/Images.js'></script>
        <script src='../src/Mouse.js'></script>
        <script src='../src/Keyboard.js'></script>
        <script src='../src/Actor.js'></script>
        <script>
            var images = {};
            var game = new Game.Game(document.querySelector("#canvas"), images);
            var actor = new Game.Actor(game);
            
            actor.expectedX = actor.x;
            actor.expectedY = actor.y;
            actor.movementSpeed = 30;
            
            actor.on("tick", function(self) {
                if (self.expectedX > self.x) {
                    self.x -= (self.x - self.expectedX) / 2;
                }
                if (self.expectedY > self.y) {
                    self.y += (self.expectedY - self.y) / 2
                }
                if (self.expectedX < self.x) {
                    self.x += (self.expectedX - self.x) / 2
                }
                if (self.expectedY < self.y) {
                    self.y -= (self.y - self.expectedY) / 2;
                }
            });
            
            actor.on("refresh", function(self) { 
                game.context.fillRect(self.x, self.y, self.width, self.height); 
            });
            
            actor.on("keyDown" + Game.KEY_UP, function(self) { 
                self.expectedY -= self.movementSpeed; 
            });

            actor.on("keyDown" + Game.KEY_RIGHT, function(self) { 
                self.expectedX += self.movementSpeed; 
            });

            actor.on("keyDown" + Game.KEY_DOWN, function(self) { 
                self.expectedY += self.movementSpeed; 
            });

            actor.on("keyDown" + Game.KEY_LEFT, function(self) { 
                self.expectedX -= self.movementSpeed; 
            });

            actor.on("mouseDrag", function(self, e) {
                self.expectedX = self.x = e.x - self.width / 2;
                self.expectedY = self.y = e.y - self.height / 2;
            });
            
            game.start();
        </script>
    </body>
</html>
